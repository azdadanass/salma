<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui" xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:fn="http://java.sun.com/jsp/jstl/functions">


	<div class="row">
		<div class="col-xs-12 col-sm-6">
			<div class="profile-user-info profile-user-info-striped">
				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Numero" />
					</div>

					<div class="profile-info-value">
						<h:outputText value="#{poView.model.numero}" styleClass="bolder orange" />
						&nbsp;
					</div>
				</div>
				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Supplier" />
					</div>
					<div class="profile-info-value">
						<h:outputText value="#{poView.model.supplier.name}" styleClass="green" />
						&nbsp;
					</div>
				</div>
				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Date" />
					</div>

					<div class="profile-info-value">
						<h:outputText value="#{poView.model.date}">
							<f:convertDateTime pattern="yyyy-MM-dd" />
						</h:outputText>
						&nbsp;
					</div>
				</div>
				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Total Amount" />
					</div>
					<div class="profile-info-value">
						<h:outputText value="#{poView.model.amountHt}">
							<f:convertNumber type="number" maxFractionDigits="2" minFractionDigits="2" />
						</h:outputText>
						<h:outputText value=" #{poView.model.currency.name}" />
						&nbsp;
					</div>
				</div>

				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="From Catalog" />
					</div>
					<div class="profile-info-value">
						<h:outputText value="#{poView.model.fromCatalog?poView.model.catalog.name:'No'}" styleClass="label arrowed #{poView.model.fromCatalog?'label-success':'label-danger'}" />
						&nbsp;
					</div>
				</div>

				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Supplier Acct Code" title="MAD Conversion Rate" />
					</div>

					<div class="profile-info-value">
						<h:outputText id="supplierAccountingCode" value="#{poView.model.supplierAccountingCode}" />
						<p:overlayPanel for="supplierAccountingCode" style="text-align: left;width:350px" showEvent="mouseover" hideEvent="mouseout">
							<h:outputText value="#{accountingSystemView.findNameByNumero(poView.model.companyId,poView.model.supplierAccountingCode)}" />
						</p:overlayPanel>
						&nbsp;
					</div>
				</div>
			</div>
		</div>
		<div class="col-xs-12 col-sm-6">
			<div class="profile-user-info profile-user-info-striped">
				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Status" />
					</div>

					<div class="profile-info-value">
						<h:outputText value="#{poView.model.status.value}" styleClass="#{poView.model.status.color.name}" />
						&nbsp;
					</div>
				</div>
				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Cost Category" />
					</div>

					<div class="profile-info-value">
						<h:outputText value="#{poView.model.costCategory.value}" styleClass="#{poView.model.costCategory.color} bolder" />
						&nbsp;
					</div>
				</div>
				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Company" />
					</div>

					<div class="profile-info-value">
						<h:outputText value="#{poView.model.company.name}" />
						&nbsp;
					</div>
				</div>

				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Project" />
					</div>

					<div class="profile-info-value">
						<h:outputText value="#{poView.model.project.name}" styleClass="orange" />
						&nbsp;
					</div>
				</div>

				<div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Currency" />
					</div>

					<div class="profile-info-value">
						<h:outputText value="#{poView.model.currency.name}" />
						&nbsp;
					</div>
				</div>

				<!-- <div class="profile-info-row">
					<div class="profile-info-name">
						<h:outputText value="Service Code" />
					</div>

					<div class="profile-info-value">
						<h:outputText value="#{poView.model.serviceCode}" />
						&nbsp;
					</div>
				</div> -->
			</div>
		</div>
	</div>
	<h4 class="header blue bolder smaller">
		<h:outputText value="Detail List" />
	</h4>
	<div class="row">
		<div class="col-sm-offset-1 col-sm-10">
			<div class="table-header col-sm-12 col-xs-12">
				<div class="col-sm-9 hidden-xs">
					<i class="fa fa-list" />
					<h:outputText value=" Details" />
				</div>
			</div>
			<div class="col-sm-12 col-xs-12 aa-datatable-container">
				<p:dataTable id="detailList" value="#{poView.model.detailList}" var="item" rows="20" styleClass="table table-striped table-hover" paginatorAlwaysVisible="false" paginator="true"
					paginatorPosition="bottom" paginatorTemplate="{JumpToPageDropdown} {LastPageLink} {FirstPageLink}  {PageLinks}">

					<p:column headerText="Reference" width="80">
						<h:outputText value="#{item.reference}" />
					</p:column>

					<p:column headerText="Service Code" width="100">
						<h:panelGroup id="serviceCode">
							<h:outputText value="#{item.serviceCode}" styleClass="green bolder" rendered="#{!poView.canUpdateServiceCode()}" />
							<p:inplace editor="true" styleClass="editable-click" saveLabel="save" cancelLabel="cancel" effect="none" emptyLabel="None" rendered="#{poView.canUpdateServiceCode()}">
								<h:selectOneMenu value="#{item.serviceCode}">
									<f:selectItem itemLabel="---" noSelectionOption="true" />
									<f:selectItems value="#{poView.model.supplier.getServiceCodeValuesList(poView.model.companyId)}" var="serviceCode" itemLabel="#{serviceCode}" itemValue="#{serviceCode}" />
								</h:selectOneMenu>
								<p:ajax event="save" listener="#{poView.updateServiceCode(item)}" update=":main_form" />
								<p:ajax event="cancel" />
							</p:inplace>
						</h:panelGroup>
						<p:overlayPanel for="serviceCode" style="text-align: left;width:350px" showEvent="mouseover" hideEvent="mouseout">
							<h:outputText value="#{accountingSystemView.findNameByNumero(poView.model.companyId,item.serviceCode)}" />
						</p:overlayPanel>
					</p:column>

					<p:column headerText="Cost Type" width="150">
						<h:outputText value="#{item.costType.value}" styleClass="purple" />
					</p:column>

					<p:column headerText="Description">
						<h:outputText value="#{item.catalogDetail.description} " rendered="#{item.catalogDetail!=null}" />
						<h:outputText value="#{item.description}" />
					</p:column>

					<p:column headerText="VAT" width="100">
						<h:outputText value="#{item.vat}" styleClass="pink">
							<f:convertNumber type="number" maxFractionDigits="0" />
						</h:outputText>
						<h:outputText value=" %" styleClass="pink" />
					</p:column>

					<p:column headerText="VAT Code" width="100">
						<h:outputText id="vatAccountingCode" value="#{item.vatAccountingCode}" />
						<p:overlayPanel for="vatAccountingCode" style="text-align: left;width:350px" showEvent="mouseover" hideEvent="mouseout">
							<h:outputText value="#{accountingSystemView.findNameByNumero(poView.model.companyId,item.vatAccountingCode)}" />
						</p:overlayPanel>
					</p:column>

					<p:column headerText="Quantity" width="120">
						<h:outputText value="#{item.quantity}" />
						<h:outputText value=" #{item.unit}" />
					</p:column>

					<p:column headerText="Unit Price" width="120">
						<h:outputText value="#{item.unitPrice}" styleClass="orange">
							<f:convertNumber type="number" maxFractionDigits="4" minFractionDigits="2" />
						</h:outputText>
						<h:outputText value=" #{poView.model.currency.name}" styleClass="orange" />
					</p:column>

					<p:column headerText="Total Price" width="120">
						<h:outputText value="#{item.amountHt}" styleClass="green">
							<f:convertNumber type="number" maxFractionDigits="2" minFractionDigits="2" />
						</h:outputText>
						<h:outputText value=" #{poView.model.currency.name}" styleClass="green" />
					</p:column>
					
					<p:column headerText="Actions" width="150" exportable="false" rendered="#{poView.isViewPage and poView.model.containsProjectGoodsPurchase()}">
						<div class="action-buttons center">
							<p:commandLink title="BoQ" action="#{poView.refreshPoDetail()}" rendered="#{poView.canViewBoqList(item)}" update=":boqForm" oncomplete="PF('boqDlg').show()">
								<i class="ace-icon fa fa-list-alt bigger-130  #{item.isBoqMapped?'green':'red'}" />
								<f:setPropertyActionListener value="#{item}" target="#{poView.poDetail}" />
							</p:commandLink>
						</div>
					</p:column>

				</p:dataTable>
			</div>
		</div>
	</div>
	<div style="width: 90%; margin: auto;">
		<div class="hr hr8 hr-double hr-dotted"></div>
		<div class="row">
			<div class="col-sm-7 pull-right">
				<h4 class="pull-right" style="font-size: 14px">
					<h:outputText value="Total Amount HT " />
					<span class="blue">
						<h:outputText value="#{poView.model.detailListTotalAmountHt}">
							<f:convertNumber type="number" maxFractionDigits="2" minFractionDigits="2" />
						</h:outputText>
						<h:outputText value=" #{poView.model.currency.name}" />
					</span>
					<h:outputText value="Total Amount TTC " style="margin-left: 20px" />
					<span class="green">
						<h:outputText value="#{poView.model.detailListTotalAmountTtc}">
							<f:convertNumber type="number" maxFractionDigits="2" minFractionDigits="2" />
						</h:outputText>
						<h:outputText value=" #{poView.model.currency.name}" />
					</span>
				</h4>
			</div>
			<div class="col-sm-5 pull-left">
				<h:outputText value="Extra Information" />
			</div>
		</div>
	</div>
	<h4 class="header blue bolder smaller">
		<h:outputText value="Invoicing Terms" />
	</h4>
	<div class="row">
		<div class="col-sm-offset-1 col-sm-10">
			<div class="table-header col-sm-12 col-xs-12">
				<div class="col-sm-9 hidden-xs">
					<i class="fa fa-list" />
					<h:outputText value=" Invoicing Terms" />
				</div>
			</div>
			<div class="col-sm-12 col-xs-12 aa-datatable-container">
				<p:dataTable value="#{poView.model.invoiceTermTemplate.detailList}" var="item" rows="20" styleClass="table table-striped table-hover center" paginatorAlwaysVisible="false" paginator="true"
					paginatorPosition="bottom" paginatorTemplate="{JumpToPageDropdown} {LastPageLink} {FirstPageLink}  {PageLinks}">

					<p:column headerText="Numero" width="80">
						<h:outputText value="#{item.numero}" />
					</p:column>

					<p:column headerText="Phase">
						<h:outputText value="#{item.phase}" styleClass="blue bolder" />
					</p:column>

					<p:column headerText="Percentage">
						<h:outputText value="#{item.percentage} %" styleClass="blue green" />
					</p:column>

				</p:dataTable>
			</div>
		</div>
	</div>
	<h4 class="header blue bolder smaller">
		<h:outputText value="Payment Terms" />
	</h4>
	<h:panelGroup id="paymentTermList">
		<ui:repeat var="invoiceTerm" value="#{poView.model.invoiceTermTemplate.detailList}">
			<div class="row">
				<div class="col-sm-offset-1 col-sm-10">
					<div class="table-header col-sm-12 col-xs-12">
						<i class="fa fa-list" />
						<h:outputText value=" #{invoiceTerm.numero} - #{invoiceTerm.phase}" />
					</div>
					<div class="col-sm-12 col-xs-12 aa-datatable-container">
						<p:dataTable id="detailList" value="#{invoiceTerm.detailList}" var="item" rows="20" styleClass="table table-striped table-hover center" paginatorAlwaysVisible="false" paginator="true"
							paginatorPosition="bottom" paginatorTemplate="{JumpToPageDropdown} {LastPageLink} {FirstPageLink}  {PageLinks}" rowIndexVar="rowIndexVar">

							<p:column headerText="Number">
								<h:outputText value="#{item.numero}" styleClass="bolder green" />
							</p:column>

							<p:column headerText="Percentage">
								<h:outputText value="#{item.percentage}" />
							</p:column>

							<p:column headerText="Start Point">
								<h:outputText value="#{item.startPoint.value}" />
							</p:column>

							<p:column headerText="Duration">
								<h:outputText value="#{item.duration}" />
							</p:column>
						</p:dataTable>
					</div>
				</div>
			</div>
			<div class="space-8" />
		</ui:repeat>
	</h:panelGroup>
	<div class="space-16" />
	<div style="width: 90%; margin: auto;">
		<div class="well">
			<h4 class="green smaller lighter">
				<h:outputText value="Comment" />
			</h4>
			<h:outputText value="#{poView.model.comment}" styleClass="preformatted" />
		</div>
	</div>




</ui:composition>